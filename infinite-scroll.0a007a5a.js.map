{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,iEAUqC,SAAjCC,aAAaC,QAAQ,UACvB,EAAAC,EAAAC,eAGF,IAAIC,EAAc,KACdC,EAAe,KACnB,MAAMC,EAAU,IAAIC,EAAAC,GAAJ,CAAmB,cAEnCC,EAAAC,SAASC,KAAKC,iBAAiB,UAS/B,SAAqBC,GAiBnB,GAhBAA,EAAIC,iBACJL,EAAAC,SAASK,MAAMC,UAAUC,IAAI,mBAC7BR,EAAAC,SAASQ,IAAIC,UAAY,GACzBd,EAAe,KACfD,EAAc,EAEdC,EAAeQ,EAAIO,cAAcV,SAASW,YAAYC,MACnDC,OACAC,MAAM,KACNC,QAAOC,GAAiB,KAATA,IACfC,KAAK,KACLC,cACHf,EAAIO,cAAcV,SAASW,YAAYC,MAAQjB,EAC5CmB,MAAM,KACNG,KAAK,KAEa,KAAjBtB,EACF,OAAOP,EAAA+B,OAAOC,QACZ,gFAIJ,EAAAC,EAAAC,aAAY3B,EAAcD,GACvB6B,MAAK,EAAGC,MAAMC,UAAEA,EAASC,KAAEA,OAC1B,GAAkB,IAAdD,EACF,OAAOrC,EAAA+B,OAAOQ,QACZ,4EAIJvC,EAAA+B,OAAOS,QAAQ,oBAAoBH,cAEnC,EAAAjC,EAAAqC,cAAaH,GACb9B,EAAQkC,UAER/B,EAAAC,SAASK,MAAMC,UAAUyB,OAAO,mBAC5BrC,EAAc+B,EAAYJ,EAAAW,QAC5BC,EAAeC,QAAQnC,EAAAC,SAASK,OAEhC8B,EAAQD,QAAQnC,EAAAC,SAASK,MAAM,IAGlC+B,OAAMC,GAAOjD,EAAA+B,OAAOQ,QAAQU,EAAIC,WAChCC,SAAQ,IAAMC,EAAAC,QAAQV,U,IApD3BhC,EAAAC,SAAS0C,aAAaxC,iBAAiB,QAASV,EAAAmD,cAChD5C,EAAAC,SAAS4C,YAAY1C,iBAAiB,QAASV,EAAAC,aAE/C,MAAM0C,EAAU,IAAIU,sBAwEpB,SAAqBC,GACnBA,EAAQC,SAAQC,IACVA,EAAMC,iBACR7D,EAAA+B,OAAOC,QACL,8DAEFe,EAAQe,UAAUnD,EAAAC,SAASK,O,MA9EqB,CAAE8C,WAAY,SAC9DlB,EAAiB,IAAIY,sBAmD3B,SAAuBC,GACrBA,EAAQC,SAAQC,IACVA,EAAMC,iBACRvD,KACA,EAAA2B,EAAAC,aAAY3B,EAAcD,GACvB6B,MAAK,EAAGC,MAAMC,UAAEA,EAASC,KAAEA,QAC1B,EAAAlC,EAAAqC,cAAaH,GACb9B,EAAQkC,UAEJpC,GAAe+B,EAAYJ,EAAAW,UAC7BG,EAAQD,QAAQnC,EAAAC,SAASK,OACzB4B,EAAeiB,UAAUnD,EAAAC,SAASK,O,IAGrC+B,OAAMC,GAAOjD,EAAA+B,OAAOQ,QAAQU,EAAIC,WAChCC,SAAQ,IAAMC,EAAAC,QAAQV,W,MAlEgC,CAC7DoB,WAAY","sources":["src/js/infinite-scroll.js"],"sourcesContent":["import { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport { Loading } from 'notiflix/build/notiflix-loading-aio';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { elements } from './my-modules/elements';\nimport { createMarkup, handlerLight, handlerDark } from './my-modules/helpers';\nimport { serviceImgs, perPage } from './my-modules/pixabay-api';\n\nif (localStorage.getItem('them') === 'dark') {\n  handlerDark();\n}\n\nlet currentPage = null;\nlet currentValue = null;\nconst gallery = new SimpleLightbox('.gallery a');\n\nelements.form.addEventListener('submit', handlerForm);\nelements.lightThemBtn.addEventListener('click', handlerLight);\nelements.darkThemBtn.addEventListener('click', handlerDark);\n\nconst warning = new IntersectionObserver(lastElement, { rootMargin: '10px' });\nconst infiniteScroll = new IntersectionObserver(handlerScroll, {\n  rootMargin: '500px',\n});\n\nfunction handlerForm(evt) {\n  evt.preventDefault();\n  elements.guard.classList.add('visually-hidden');\n  elements.box.innerHTML = '';\n  currentValue = null;\n  currentPage = 1;\n\n  currentValue = evt.currentTarget.elements.searchQuery.value\n    .trim()\n    .split(' ')\n    .filter(elem => elem !== '')\n    .join('+')\n    .toLowerCase();\n  evt.currentTarget.elements.searchQuery.value = currentValue\n    .split('+')\n    .join(' ');\n\n  if (currentValue === '') {\n    return Notify.warning(\n      \"We can't find this, because you haven't entered anything. Please try again.\"\n    );\n  }\n\n  serviceImgs(currentValue, currentPage)\n    .then(({ data: { totalHits, hits } }) => {\n      if (totalHits === 0) {\n        return Notify.failure(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n      }\n\n      Notify.success(`Hooray! We found ${totalHits} images.`);\n\n      createMarkup(hits);\n      gallery.refresh();\n\n      elements.guard.classList.remove('visually-hidden');\n      if (currentPage < totalHits / perPage) {\n        infiniteScroll.observe(elements.guard);\n      } else {\n        warning.observe(elements.guard);\n      }\n    })\n    .catch(err => Notify.failure(err.message))\n    .finally(() => Loading.remove());\n}\n\nfunction handlerScroll(entries) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      currentPage++;\n      serviceImgs(currentValue, currentPage)\n        .then(({ data: { totalHits, hits } }) => {\n          createMarkup(hits);\n          gallery.refresh();\n\n          if (currentPage >= totalHits / perPage) {\n            warning.observe(elements.guard);\n            infiniteScroll.unobserve(elements.guard);\n          }\n        })\n        .catch(err => Notify.failure(err.message))\n        .finally(() => Loading.remove());\n    }\n  });\n}\n\nfunction lastElement(entries) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      Notify.warning(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n      warning.unobserve(elements.guard);\n    }\n  });\n}\n"],"names":["$iQIUW","parcelRequire","localStorage","getItem","$kP3O0","handlerDark","$7f13665ecc617d63$var$currentPage","$7f13665ecc617d63$var$currentValue","$7f13665ecc617d63$var$gallery","$parcel$interopDefault","$fZKcF","$iGUrG","elements","form","addEventListener","evt","preventDefault","guard","classList","add","box","innerHTML","currentTarget","searchQuery","value","trim","split","filter","elem","join","toLowerCase","Notify","warning","$h5xPl","serviceImgs","then","data","totalHits","hits","failure","success","createMarkup","refresh","remove","perPage","$7f13665ecc617d63$var$infiniteScroll","observe","$7f13665ecc617d63$var$warning","catch","err","message","finally","$dSs1Y","Loading","lightThemBtn","handlerLight","darkThemBtn","IntersectionObserver","entries","forEach","entry","isIntersecting","unobserve","rootMargin"],"version":3,"file":"infinite-scroll.0a007a5a.js.map"}