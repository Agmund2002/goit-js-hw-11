{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,iEAUqC,SAAjCC,aAAaC,QAAQ,UACvB,EAAAC,EAAAC,eAGF,IAAIC,EAAc,KACdC,EAAe,KACnB,MAAMC,EAAU,IAAIC,EAAAC,GAAJ,CAAmB,cAEnCC,EAAAC,SAASC,KAAKC,iBAAiB,UAO/B,SAAqBC,GAgBnB,GAfAA,EAAIC,iBACJL,EAAAC,SAASK,IAAIC,UAAY,GACzBX,EAAe,KACfD,EAAc,EAEdC,EAAeQ,EAAII,cAAcP,SAASQ,YAAYC,MACnDC,OACAC,MAAM,KACNC,QAAOC,GAAiB,KAATA,IACfC,KAAK,KACLC,cACHZ,EAAII,cAAcP,SAASQ,YAAYC,MAAQd,EAC5CgB,MAAM,KACNG,KAAK,KAEa,KAAjBnB,EACF,OAAOP,EAAA4B,OAAOC,QACZ,gFAIJ,EAAAC,EAAAC,aAAYxB,EAAcD,GACvB0B,MAAK,EAAGC,MAAMC,UAAEA,EAASC,KAAEA,OAC1B,GAAkB,IAAdD,EACF,OAAOlC,EAAA4B,OAAOQ,QACZ,4EAIJpC,EAAA4B,OAAOS,QAAQ,oBAAoBH,cAEnC,EAAA9B,EAAAkC,cAAaH,GACb3B,EAAQ+B,UAEJjC,EAAc4B,EAAYJ,EAAAU,QAC5B7B,EAAAC,SAAS6B,YAAYC,UAAUC,OAAO,oBAEtChC,EAAAC,SAASgC,MAAMF,UAAUC,OAAO,mBAChCE,EAAQC,QAAQnC,EAAAC,SAASgC,O,IAG5BG,OAAMC,GAAOhD,EAAA4B,OAAOQ,QAAQY,EAAIC,WAChCC,SAAQ,IAAMC,EAAAC,QAAQT,U,IAjD3BhC,EAAAC,SAAS6B,YAAY3B,iBAAiB,SAoDtC,WACER,KACA,EAAAwB,EAAAC,aAAYxB,EAAcD,GACvB0B,MAAK,EAAGC,MAAMC,UAAEA,EAASC,KAAEA,QAC1B,EAAA/B,EAAAkC,cAAaH,GACb3B,EAAQ+B,UAEJjC,GAAe4B,EAAYJ,EAAAU,UAC7B7B,EAAAC,SAAS6B,YAAYC,UAAUW,IAAI,mBACnC1C,EAAAC,SAASgC,MAAMF,UAAUC,OAAO,mBAChCE,EAAQC,QAAQnC,EAAAC,SAASgC,O,IAG5BG,OAAMC,GAAOhD,EAAA4B,OAAOQ,QAAQY,EAAIC,WAChCC,SAAQ,IAAMC,EAAAC,QAAQT,U,IAjE3BhC,EAAAC,SAAS0C,aAAaxC,iBAAiB,QAASV,EAAAmD,cAChD5C,EAAAC,SAAS4C,YAAY1C,iBAAiB,QAASV,EAAAC,aAE/C,MAAMwC,EAAU,IAAIY,sBAiEpB,SAAqBC,GACnBA,EAAQC,SAAQC,IACVA,EAAMC,iBACR7D,EAAA4B,OAAOC,QACL,8DAEFgB,EAAQiB,UAAUnD,EAAAC,SAASgC,OAC3BjC,EAAAC,SAASgC,MAAMF,UAAUW,IAAI,mB,MAxEmB,CAAEU,WAAY","sources":["src/js/load-more-button.js"],"sourcesContent":["import { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport { Loading } from 'notiflix/build/notiflix-loading-aio';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { elements } from './my-modules/elements';\nimport { createMarkup, handlerLight, handlerDark } from './my-modules/helpers';\nimport { serviceImgs, perPage } from './my-modules/pixabay-api';\n\nif (localStorage.getItem('them') === 'dark') {\n  handlerDark();\n}\n\nlet currentPage = null;\nlet currentValue = null;\nconst gallery = new SimpleLightbox('.gallery a');\n\nelements.form.addEventListener('submit', handlerForm);\nelements.loadMoreBtn.addEventListener('click', handlerLoadMore);\nelements.lightThemBtn.addEventListener('click', handlerLight);\nelements.darkThemBtn.addEventListener('click', handlerDark);\n\nconst warning = new IntersectionObserver(lastElement, { rootMargin: '10px' });\n\nfunction handlerForm(evt) {\n  evt.preventDefault();\n  elements.box.innerHTML = '';\n  currentValue = null;\n  currentPage = 1;\n\n  currentValue = evt.currentTarget.elements.searchQuery.value\n    .trim()\n    .split(' ')\n    .filter(elem => elem !== '')\n    .join('+')\n    .toLowerCase();\n  evt.currentTarget.elements.searchQuery.value = currentValue\n    .split('+')\n    .join(' ');\n\n  if (currentValue === '') {\n    return Notify.warning(\n      \"We can't find this, because you haven't entered anything. Please try again.\"\n    );\n  }\n\n  serviceImgs(currentValue, currentPage)\n    .then(({ data: { totalHits, hits } }) => {\n      if (totalHits === 0) {\n        return Notify.failure(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n      }\n\n      Notify.success(`Hooray! We found ${totalHits} images.`);\n\n      createMarkup(hits);\n      gallery.refresh();\n\n      if (currentPage < totalHits / perPage) {\n        elements.loadMoreBtn.classList.remove('visually-hidden');\n      } else {\n        elements.guard.classList.remove('visually-hidden');\n        warning.observe(elements.guard);\n      }\n    })\n    .catch(err => Notify.failure(err.message))\n    .finally(() => Loading.remove());\n}\n\nfunction handlerLoadMore() {\n  currentPage++;\n  serviceImgs(currentValue, currentPage)\n    .then(({ data: { totalHits, hits } }) => {\n      createMarkup(hits);\n      gallery.refresh();\n\n      if (currentPage >= totalHits / perPage) {\n        elements.loadMoreBtn.classList.add('visually-hidden');\n        elements.guard.classList.remove('visually-hidden');\n        warning.observe(elements.guard);\n      }\n    })\n    .catch(err => Notify.failure(err.message))\n    .finally(() => Loading.remove());\n}\n\nfunction lastElement(entries) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      Notify.warning(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n      warning.unobserve(elements.guard);\n      elements.guard.classList.add('visually-hidden');\n    }\n  });\n}\n"],"names":["$iQIUW","parcelRequire","localStorage","getItem","$kP3O0","handlerDark","$d4e96570f581a736$var$currentPage","$d4e96570f581a736$var$currentValue","$d4e96570f581a736$var$gallery","$parcel$interopDefault","$fZKcF","$iGUrG","elements","form","addEventListener","evt","preventDefault","box","innerHTML","currentTarget","searchQuery","value","trim","split","filter","elem","join","toLowerCase","Notify","warning","$h5xPl","serviceImgs","then","data","totalHits","hits","failure","success","createMarkup","refresh","perPage","loadMoreBtn","classList","remove","guard","$d4e96570f581a736$var$warning","observe","catch","err","message","finally","$dSs1Y","Loading","add","lightThemBtn","handlerLight","darkThemBtn","IntersectionObserver","entries","forEach","entry","isIntersecting","unobserve","rootMargin"],"version":3,"file":"load-more-button.b4d44fa6.js.map"}